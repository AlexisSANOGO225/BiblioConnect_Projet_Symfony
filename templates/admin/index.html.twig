{% extends 'base.html.twig' %}

{% block title %}Hello ProfileUserController!
{% endblock %}

{% block body %}
	<!-- Afficher les alertes en haut de la page -->
	{% for label, messages in app.flashes %}
		<div class="alert alert-{{ label }}">
			{% for message in messages %}
				<p>{{ message }}</p>
			{% endfor %}
		</div>
	{% endfor %}

	<section class="h-100 gradient-custom-2">
		<div class="container py-5 h-100">
			<div class="row d-flex justify-content-center">
				<div class="col-12">
					<div class="card">
						<div class="rounded-top text-white d-flex flex-row" style="background-color: #000; height:200px;">
							<div class="ms-4 mt-5 d-flex flex-column" style="width: 150px;">
								<img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-profiles/avatar-{{ random([1, 2]) }}.webp" alt="Generic placeholder image" class="img-fluid img-thumbnail mt-4 mb-2" style="width: 150px; z-index: 1">
							</div>
							<div class="ms-3" style="margin-top: 130px;">
								<h5>{{ app.user.username }}</h5>
								<p>Paris, France</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row mt-5">
				<div class="col-sm-6 col-xl-3">
					<div class="card mt-3">
						<div class="card-body">
							<div class="row">
								<div class="col mt-0">
									<h5 class="card-title">Gestion des livres</h5>
								</div>

								<div class="col-auto">
									<div class="stat text-primary">
										<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-book" viewbox="0 0 16 16">
											<path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"/>
										</svg>
									</div>
								</div>
							</div>
							<h2 class="mt-1 mb-3">{{ bookCount }}</h2>
						</div>
					</div>
					<a class="btn btn-primary w-100" href="{{ path('app_books_index') }}">Accéder</a>
				</div>
				<div class="col-sm-6 col-xl-3">
					<div class="card mt-3">
						<div class="card-body">
							<div class="row">
								<div class="col mt-0">
									<h5 class="card-title">Gestion des auteurs</h5>
								</div>

								<div class="col-auto">
									<div class="stat text-primary">
										<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-person-bounding-box" viewbox="0 0 16 16">
											<path d="M1.5 1a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-1 0v-3A1.5 1.5 0 0 1 1.5 0h3a.5.5 0 0 1 0 1zM11 .5a.5.5 0 0 1 .5-.5h3A1.5 1.5 0 0 1 16 1.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 1-.5-.5M.5 11a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 1 0 14.5v-3a.5.5 0 0 1 .5-.5m15 0a.5.5 0 0 1 .5.5v3a1.5 1.5 0 0 1-1.5 1.5h-3a.5.5 0 0 1 0-1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 1 .5-.5"/>
											<path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm8-9a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
										</svg>
									</div>
								</div>
							</div>
							<h2 class="mt-1 mb-3">{{ authorCount }}</h2>
						</div>
					</div>
					<a class="btn btn-primary w-100" href="{{ path('app_authors_index') }}">Accéder</a>
				</div>
				<div class="col-sm-6 col-xl-3">
					<div class="card mt-3">
						<div class="card-body">
							<div class="row">
								<div class="col mt-0">
									<h5 class="card-title">Gestion des catégories</h5>
								</div>

								<div class="col-auto">
									<div class="stat text-primary">
										<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-bookmarks-fill" viewbox="0 0 16 16">
											<path d="M2 4a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v11.5a.5.5 0 0 1-.777.416L7 13.101l-4.223 2.815A.5.5 0 0 1 2 15.5z"/>
											<path d="M4.268 1A2 2 0 0 1 6 0h6a2 2 0 0 1 2 2v11.5a.5.5 0 0 1-.777.416L13 13.768V2a1 1 0 0 0-1-1z"/>
										</svg>
									</div>
								</div>
							</div>
							<h3 class="mt-1 mb-3">{{ categoryCount }}</h3>
						</div>
					</div>
					<a class="btn btn-primary w-100" href="{{ path('app_categories_index') }}">Accéder</a>
				</div>
				<div class="col-sm-6 col-xl-3">
					<div class="card mt-3">
						<div class="card-body">
							<div class="row">
								<div class="col mt-0">
									<h5 class="card-title">Gestion des langues</h5>
								</div>

								<div class="col-auto">
									<div class="stat text-primary">
										<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-translate" viewbox="0 0 16 16">
											<path d="M4.545 6.714 4.11 8H3l1.862-5h1.284L8 8H6.833l-.435-1.286zm1.634-.736L5.5 3.956h-.049l-.679 2.022z"/>
											<path d="M0 2a2 2 0 0 1 2-2h7a2 2 0 0 1 2 2v3h3a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-3H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zm7.138 9.995q.289.451.63.846c-.748.575-1.673 1.001-2.768 1.292.178.217.451.635.555.867 1.125-.359 2.08-.844 2.886-1.494.777.665 1.739 1.165 2.93 1.472.133-.254.414-.673.629-.89-1.125-.253-2.057-.694-2.82-1.284.681-.747 1.222-1.651 1.621-2.757H14V8h-3v1.047h.765c-.318.844-.74 1.546-1.272 2.13a6 6 0 0 1-.415-.492 2 2 0 0 1-.94.31"/>
										</svg>
									</div>
								</div>
							</div>
							<h3 class="mt-1 mb-3">{{ languageCount }}</h3>
						</div>
					</div>
					<a class="btn btn-primary w-100" href="{{ path('app_languages_index') }}">Accéder</a>
				</div>
				{% if is_granted('ROLE_ADMIN') %}
					<div class="col-sm-6 col-xl-3">
						<div class="card mt-3">
							<div class="card-body">
								<div class="row">
									<div class="col mt-0">
										<h5 class="card-title">Gestion commentaires</h5>
									</div>

									<div class="col-auto">
										<div class="stat text-primary">
											<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-chat-quote" viewbox="0 0 16 16">
												<path d="M2.678 11.894a1 1 0 0 1 .287.801 11 11 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8 8 0 0 0 8 14c3.996 0 7-2.807 7-6s-3.004-6-7-6-7 2.808-7 6c0 1.468.617 2.83 1.678 3.894m-.493 3.905a22 22 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a10 10 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9 9 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105"/>
												<path d="M7.066 6.76A1.665 1.665 0 0 0 4 7.668a1.667 1.667 0 0 0 2.561 1.406c-.131.389-.375.804-.777 1.22a.417.417 0 0 0 .6.58c1.486-1.54 1.293-3.214.682-4.112zm4 0A1.665 1.665 0 0 0 8 7.668a1.667 1.667 0 0 0 2.561 1.406c-.131.389-.375.804-.777 1.22a.417.417 0 0 0 .6.58c1.486-1.54 1.293-3.214.682-4.112z"/>
											</svg>
										</div>
									</div>
								</div>
								<h3 class="mt-1 mb-3">{{ reviewCount }}</h3>
							</div>
						</div>
						<a class="btn btn-primary w-100" href="{{ path('app_reviews_index') }}">Accéder</a>
					</div>

					<div class="col-sm-6 col-xl-3">
						<div class="card mt-3">
							<div class="card-body">
								<div class="row">
									<div class="col mt-0">
										<h5 class="card-title">Gestion des utilisateurs</h5>
									</div>

									<div class="col-auto">
										<div class="stat text-primary">
											<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-people" viewbox="0 0 16 16">
												<path d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1zm-7.978-1L7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002-.014.002zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0M6.936 9.28a6 6 0 0 0-1.23-.247A7 7 0 0 0 5 9c-4 0-5 3-5 4q0 1 1 1h4.216A2.24 2.24 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816M4.92 10A5.5 5.5 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0m3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4"/>
											</svg>
										</div>
									</div>
								</div>
								<h3 class="mt-1 mb-3">{{ accountCount }}</h3>
							</div>
						</div>
						<a class="btn btn-primary w-100" href="{{ path('app_accounts_index') }}">Accéder</a>
					</div>

				{% endif %}
			</div>

			<h3 class="mt-5">Historique des reservation</h3>
			<table class="table align-middle mb-0 bg-white mt-4">
				<thead class="bg-light">
					<tr>
						<th>Nom Client</th>
						<th>Titre Livre</th>
						<th>Date de reservation</th>
						<th>Action</th>
					</tr>
				</thead>
				<tbody>
					{% for reservation in reservations %}
						<tr>
							<td>
								<div class="d-flex align-items-center">
									<img src="https://mdbootstrap.com/img/new/avatars/{{ random(1..20) }}.jpg" alt="" style="width: 45px; height: 45px" class="rounded-circle"/>
									<div class="ms-3">
										<p class="fw-bold mb-1">{{ reservation.accounts.username }}</p>
										<p class="text-muted mb-0">{{ reservation.accounts.email}}</p>
									</div>
								</div>
							</td>
							<td>
								<p class="fw-normal mb-1">{{ reservation.books.title }}</p>
								<p class="text-muted mb-0">{{ reservation.books.theme }}</p>
							</td>
							<td>
								<p class="fw-normal mb-1">{{ reservation.createdAt | date('d-m-Y H:i:s') }}</p>
							</td>
							<td>
								{% if is_granted('ROLE_ADMIN') %}
									<a class="btn btn-danger btn-rounded btn-sm fw-bold" href="{{ path('app_reservations_delete', {id: reservation.id}) }}" data-mdb-ripple-color="dark">
										Supprimer
									</a>
								{% endif %}
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</section>


{% endblock %}
